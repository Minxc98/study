# db  tb split  #
在路由过程中，不能查询数据库？？

深入了解
1、基本使用、原理
2、不足、对比
3、优化点、坑



## 目录大纲 ##
#### 背景

#### 问题挑战

#### 方案选择

#### 业务实践

#### 注意事项

#### Q&A



## 背景 ##
业务增长，数据量剧增

单库单表瓶颈问题处理

## 困难挑战

- 优点

  1.	解决性能瓶颈问题，提高查询效率
  2.	降低数据库读写压力
  3.	

- 挑战

  1. join、queryByPage、group by等操作变得难实现或不能实现
  2. 增加程序实现的复杂性
  3. 需知道 数据存在于哪个数据库
  4. 跨库分布式事务
  5. 数据扩容
  6. 关联查询


## 方案对比 ##
star、迭代频率、团队、优点（性能、方便、成本）、不足（限制、）

列一个表格？

数据库代理

MyCat

数据库中间件

DAL

Sharding-JDBC



原因：

## 业务实践 ##

### 新库新表 ###

新的数据库、新的表结构

mock 几个简单的表结构

### 服务收口

数据库代理

服务依赖关系图

埋点监控（耗时统计）

### 分片算法 ###

数据库路由算法，先分组、在取模

### 平滑过渡 ###
过渡时期

双写

双读

Aop + Event + job

数据迁移

job

### 离线查询

宽表



## Tips

MyBatis Generator 逻辑表

update 不能更新 key 

调试配置

Shariding-JDBC 不支持 like 语句中包含分片键

## Q&A







